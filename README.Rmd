---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# rmedsem <a href="https://ihrke.github.io/rmedsem/"><img src="man/figures/logo.png" align="right" height="139" /></a>

<!-- badges: start -->
<!-- badges: end -->


The goal of rmedsem is to conduct a mediation analysis based on a model (including observed or latent variables as well as combination of observed and latent variables) estimated using lavaan's -sem- function. There are two methods medsem uses as the basis for its procedures. The first method is the commonly known Baron and Kenny approach which is adjusted by Iacobucci et al. (2007) for use with structural equation modelling. The second approach is that of Zhao et al. (2010).
  
### Adjusted Baron and Kenny's approach (default)

1) If both or one of the X->M and M->Y coefficients is not significant, there is no mediation
2) When both of the X->M and M->Y coefficients are significant, there is "some" mediation
   a) If the Sobel's z-test is significant and the X->Y coefficient is not significant, then there is complete mediation
   b) If both the Sobel's z-test and the X->Y coefficients are significant, then there is partial mediation
   c) If the Sobel's z-test is not significant but the X->Y coefficient is significant, then there is partial mediation
   d) If neither Sobel's z-test nor the X->Y coefficient are significant, then there is partial mediation

### Zhao, Lynch & Chen's approach

1) If neither Monte Carlo z-test nor the X->Y coefficient are significant, then there is no-effect nonmediation (i.e. no mediation)
2) If Monte Carlo z-test is not significant and X->Y coefficient is significant, then there is direct-only nonmediation (i.e. no mediation)
3) If Monte Carlo z-test is significant and X->Y coefficient is not significant, then there is indirect-only mediation (i.e. full mediation)
4) If both of the Monte Carlo z-test and X-Y coefficient are significant and their coefficients point in same direction, then there is complementary
    mediation (i.e. partial mediation)
5) If both of the Monte Carlo z-test and X-Y coefficient are significant and their coefficients point in opposite direction, then there is competitive mediation (i.e. partial mediation)

Note: Zhao et al. suggest bootstrap test of the indirect effect, medsem uses the Monte Carlo test instead as it is less time-consuming and still acceptable (see Jose(2013), page 122).

### References 

- Iacobucci, D., Saldanha, N., & Deng, X. (2007). A Mediation on Mediation: Evidence That Structural Equation Models Perform Better Than Regressions. Journal of Consumer Psychology, 17(2), 140-154.
- Jose, P. E. (2013). Doing Statistical Mediation & Moderation.  London: Guilford.
- MacKinnon, D. P. (2008). Introduction to statistical mediation analysis. New York: Lawrence Erlbaum.
- Zhao, X., Lynch, J. G. Jr., & Chen, Q. (2010). Reconsidering Baron and Kenny: Myths and Truths about Mediation Analysis. Journal of Consumer Research, 37(August), 197-206.

## Installation

You can install the development version of rmedsem from
[GitHub](https://github.com/) with:

```r
# install.packages("devtools")
devtools::install_github("ihrke/rmedsem")
```

## Examples 


### Example 1 (lavaan)

```{r}
library(lavaan)
library(rmedsem)

mod.txt <- "
read ~ math
science ~ read + math
"
mod <- lavaan::sem(mod.txt, data=rmedsem::hsbdemo)
out <- rmedsem(mod, indep="math", med="read", dep="science", 
               standardized=T, mcreps=5000,
               approach = c("bk","zlc"))
print(out)
```

### Example 1 (cSEM)

```{r}
library(cSEM)
library(rmedsem)

mod.txt <- "
# need to use single-item measurement models for PLS-SEM
Read =~ read
Math =~ math
Science =~ science

# the actual path model
Read ~ Math
Science ~ Read + Math
"
mod <- cSEM::csem(.model=mod.txt, .data=rmedsem::hsbdemo,
                 .resample_method = "bootstrap", .R = 200)
out <- rmedsem(mod, indep="Math", med="Read", dep="Science", 
               approach = c("bk", "zlc"))
print(out)
```

### Example 2 (lavaan)

```{r}
model02 <- "
  # measurement model
    ind60 =~ x1 + x2 + x3
    dem60 =~ y1 + y2 + y3 + y4
    dem65 =~ y5 + y6 + y7 + y8
  # regressions
    dem60 ~ ind60
    dem65 ~ ind60 + dem60
"
mod <- sem(model02, data=lavaan::PoliticalDemocracy)
out <- rmedsem(mod, indep="ind60", med="dem60", dep="dem65",
               standardized=T, mcreps=5000,
               approach = c("bk","zlc"))
print(out)
```

### Example 2 (cSEM)

```{r}
model02 <- "
  # measurement model
    ind60 =~ x1 + x2 + x3
    dem60 =~ y1 + y2 + y3 + y4
    dem65 =~ y5 + y6 + y7 + y8
  # regressions
    dem60 ~ ind60
    dem65 ~ ind60 + dem60
"
mod <- cSEM::csem(.model=model02, .data=lavaan::PoliticalDemocracy,
                  .resample_method = "bootstrap", .R = 200)
out <- rmedsem(mod, indep="ind60", med="dem60", dep="dem65",
               approach = c("bk","zlc"))
print(out)
```
### Example 3 (lavaan) 

```{r}
model03 <- "
   Attractive =~ face + sexy
   Appearance =~ body + appear + attract
   Muscle =~ muscle + strength + endur
   Weight =~ lweight + calories + cweight
   Appearance ~ Attractive + age
   Muscle ~ Appearance + Attractive + age
   Weight ~ Appearance + Attractive + age
"
mod <- sem(model03, data=rmedsem::workout)
out1 <- rmedsem(mod, indep="Attractive", med="Appearance", dep="Muscle",
               standardized=T, mcreps=5000,
               approach = c("bk","zlc"))
print(out1)
```

```{r}
out2 <- rmedsem(mod, indep="Attractive", med="Appearance", dep="Weight",
               standardized=T, mcreps=5000,
               approach = c("bk","zlc"))
print(out2)
```

```{r}
out3 <- rmedsem(mod, indep="age", med="Appearance", dep="Muscle",
                standardized=T, mcreps=5000,
                approach = c("bk","zlc"))
print(out3)
```

```{r}
out4 <- rmedsem(mod, indep="age", med="Appearance", dep="Weight",
                standardized=T, mcreps=5000,
                approach = c("bk","zlc"))
print(out4)
```

### Example 3 (cSEM) 

```{r}
model03 <- "
   Attractive =~ face + sexy
   Appearance =~ body + appear + attract
   Muscle =~ muscle + strength + endur
   Weight =~ lweight + calories + cweight
   Age =~ age ## need single-indicator LV for cSEM
   Appearance ~ Attractive + Age
   Muscle ~ Appearance + Attractive + Age
   Weight ~ Appearance + Attractive + Age
"
mod <- cSEM::csem(.model=model03, .data=na.omit(rmedsem::workout), 
                  .resample_method = "bootstrap", .R = 200)
out1 <- rmedsem(mod, indep="Attractive", med="Appearance", dep="Muscle",
               approach = c("bk","zlc"))
print(out1)
```

